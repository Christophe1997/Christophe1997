<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Computer System 3 | CastOff</title><meta name=keywords content="System"><meta name=description content="Optimization Writing an efficient program requires several type of activities. First, we must select an appropriate set of algorithms and data structures. Second, we must write source code that the compiler can effectively optimize to turn into efficient executable code. A third technique for dealing with especially demanding computations is to divide a task into portions that can be computed in parallel, on some combination of multiple cores and multiple processors."><meta name=author content="Christophe"><link rel=canonical href=https://christophe1997.github.io/posts/2018/computer-system-3/><meta name=google-site-verification content="CastOff"><link href=https://christophe1997.github.io/assets/css/stylesheet.min.6f4392ae929a8a0f8c40646695f332c58db4df0d0d1a54ddae9f5f2625a677f3.css integrity="sha256-b0OSrpKaig+MQGRmlfMyxY203w0NGlTdrp9fJiWmd/M=" rel="preload stylesheet" as=style><link rel=icon href=https://christophe1997.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://christophe1997.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://christophe1997.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://christophe1997.github.io/apple-touch-icon.png><link rel=mask-icon href=https://christophe1997.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.78.1"><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-112755173-3','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><meta property="og:title" content="Computer System 3"><meta property="og:description" content="Optimization Writing an efficient program requires several type of activities. First, we must select an appropriate set of algorithms and data structures. Second, we must write source code that the compiler can effectively optimize to turn into efficient executable code. A third technique for dealing with especially demanding computations is to divide a task into portions that can be computed in parallel, on some combination of multiple cores and multiple processors."><meta property="og:type" content="article"><meta property="og:url" content="https://christophe1997.github.io/posts/2018/computer-system-3/"><meta property="article:published_time" content="2018-06-01T23:23:16+00:00"><meta property="article:modified_time" content="2018-06-01T23:23:16+00:00"><meta property="og:site_name" content="CastOff"><meta name=twitter:card content="summary"><meta name=twitter:title content="Computer System 3"><meta name=twitter:description content="Optimization Writing an efficient program requires several type of activities. First, we must select an appropriate set of algorithms and data structures. Second, we must write source code that the compiler can effectively optimize to turn into efficient executable code. A third technique for dealing with especially demanding computations is to divide a task into portions that can be computed in parallel, on some combination of multiple cores and multiple processors."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Computer System 3","name":"Computer System 3","description":"Optimization Writing an efficient program requires several type of activities. First, we must select an appropriate set of algorithms and data structures. Second, we must write …","keywords":["System"],"articleBody":"Optimization Writing an efficient program requires several type of activities. First, we must select an appropriate set of algorithms and data structures. Second, we must write source code that the compiler can effectively optimize to turn into efficient executable code. A third technique for dealing with especially demanding computations is to divide a task into portions that can be computed in parallel, on some combination of multiple cores and multiple processors.\nAnd our goal in optimization is to keep modifying the source code in attempt to coax the compiler into generating efficient code. Compared to the alternative of writing code in assembly language, this indirect approach has the advantage that the resulting code will still run on other machines, although perhaps not with peak performance.\nCompilers must be careful to apply only safe optimizations to a program, meaning that the the resulting program will have the exact same behavior as would an unoptimized version for all possible cases the program may encounter.\nThe first problem is the memory aliasing that two pointers designate the same memory location, and in performing only safe optimizations, the compiler must assume that different pointers may be aliased. If a compiler cannot determine whether or not twopointers may be aliased, it must assume that either case is possible, limiting the set of possible optimizations\nA second optimization blocker is due to function calls. It’s hard to optimize the function calls with side effect, which modifies some part of the global program state. Most compilers do not try to determine whether a function is free of side effects, instead the compiler assumes the worse case and leaves function calls intact. Among compilers, GCC is considered adequate, but not exceptional.\nWe introduce the metric cycles per element(CPE), CPE measurements help us understand the loop performance of an iterative program at a detailed level. The sequencing of activities by a processor is controlled by a clock providing a regular signal of some frequency, usually expressed in gigahertz(GHz), billions of cycles per second. For example, when product literature characterizes a system as “4 GHz” processor, it means that the processor clock runs at 4.0E9 cycles per second, and the period of the processor is 0.25 nanoseconds, which is the reciprocal of the clock frequency.\nFor example, consider the two programs of computing the prefix sum of a vector a:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  void psum1(float a[], float p[], long n) { long i; p[0] = a[0]; for (i = 1; i  n; i++) { p[i] = p[i - 1] + a[i]; } } void psum2(float a[], float p[], long n) { long i; p[0] = a[0]; for (i = 1; i  n - 1; i += 2) { float mid_val = p[i - 1] + a[i]; p[i] = mid_val; p[i + 1] = mid_val + a[i + 1]; } if (i  n) { p[i] = p[i - 1] + a[i]; } }   They takes 368 + 9.0n cycles and 368 + 6.0 cycles, for lagre N the run times will be dominated by the linear factors. We refer to the coefficients in these terms as the effective number of cycle per element, so the first one’s CPE is 9.0 and the second one is 6.0.\nModern processors One of the remarkable feats of modern microprocessors is they employ complex and exotic microarchitectures, in which multiple instructions can be executed in parallel, while presenting an operational view of simple sequential instruction execution. There are two different lower bounds characterize the maximum performance of a program. The latency bound is encountered when a series of operations must performed in strict sequence, because the result of one operations is required before the next one can begin. This bound can limit program performance when the data dependencies in the code limit the ability of the processor to exploit instruction-level parallelism. The throughput bound characterizes the raw computing capacity of the processor’s functional units. This bound becomes the ultimate limit on program performance.\nTrick  code motion: Identify a computation that is performed multiple times but such that the result of the computation will not change, and therefor move the computation to an eailer section of the code that does not get evaluated as often. eliminate unneeded menory reference: For frequent memory reference, it could be improved by introduced a temporary variables instead of using memory referencing(pointer) in a loop. loop unrolling: Reduce the number of iterations for a loop by increasing the number of elements computed on each iteration. It can improve performance in two ways. First, it reduces the number of operations that do not contribute directly to the program result, such as loop indexing and conditional branching. Second, it expose ways in which we can futher transform the code to reduce the number of operations in the cirtical paths of the overall computation.  The Memory Hierarchy Random-access memory Random-access memory(RAM) comes in two varieties, static and dynamic. Static RAM(SRAM) is faster and significantly more expensive than dynamic RAM(DRAM). SRAM is used for cache memories, both on and off the CPU chip. DRAM is used for the amin memory plus the frame buffer of a graphics system.\nRead-only memory Read-only memory can retain their information even when they are powered off, while the RAM lose their information if the supply voltage is turned off. flash memory is a type of nonvolstile memory, based on EEPROM(electrically erasable programmable ROM), that has become an important storage rechnology. The solid state disk(SSD), that provides a faster, sturdier and less power-hungry alternative to conventional rotating disk is a new form of flash-based disk driver.\nPrinciple of Locality programs with good locality run faster than programs with poor locality. Locality is typically described as having two distinct forms: temporal locality and spatial locality. In a program with good temporal locality, a memory location that is referenced once is likely to be referenced again multiple times in the near future. In a program with good spatial locality, if a memory location that is referenced once, then the program is likely to reference a nearby memory location in the near future.\nConsider a program of matrix multiplication(C=AxB):\n1 2 3 4 5 6 7 8  for (i = 0; i  n; i++) for (j = 0; j  m; j++) { sum = 0.0; for (k = 0; k  p; k++) { sum += A[i][k] * B[k][j]; } C[i][j] = sum; }   if we switch the loop order for j and k:\n1 2 3 4 5 6 7  for (i = 0; i  n; i++) for (k = 0; k  p; j++) { r = A[i][k] for (j = 0; j  m; k++) { C[i][j] += r * B[k][j]; } }   these will not change the result, but the second improves efficiency. Because the second has no cache missing.\n Programs that repeatedly reference the same variables enjoy good temporal locality. For programs with stride-k reference patterns, the smaller the stride the better the spatial locality. Programs with stride-1 reference patterns have good spatial locality. Programs that hop around memory with large strides have poor spatial locality. Loops have good temporal and spatial locality with respect to instruction fetches. The smaller the loop body and the greater the number of loopiterations, the better the locality.  ","wordCount":"1229","inLanguage":"en","datePublished":"2018-06-01T23:23:16Z","dateModified":"2018-06-01T23:23:16Z","author":{"@type":"Person","name":"Christophe"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://christophe1997.github.io/posts/2018/computer-system-3/"},"publisher":{"@type":"Organization","name":"CastOff","logo":{"@type":"ImageObject","url":"https://christophe1997.github.io/favicon.ico"}}}</script></head><body id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><noscript><style type=text/css>.theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://christophe1997.github.io accesskey=h>CastOff</a>
<span class=logo-switches><span class=theme-toggle><a id=theme-toggle accesskey=t><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></a></span></span></div><ul class=menu id=menu onscroll=menu_on_scroll()><li><a href=https://christophe1997.github.io/tags/><span>Tags</span></a></li><li><a href=https://christophe1997.github.io/categories/><span>Categories</span></a></li><li><a href=https://christophe1997.github.io/archives/><span>Archives</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Computer System 3</h1><div class=post-meta>June 1, 2018&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Christophe</div></header><div class=post-content><h2 id=optimization>Optimization<a hidden class=anchor aria-hidden=true href=#optimization>#</a></h2><p>Writing an efficient program requires several type of activities. First, we must select an appropriate set of algorithms
and data structures. Second, we must write source code that the compiler can effectively optimize to turn into efficient
executable code. A third technique for dealing with especially demanding computations is to divide a task into portions
that can be computed in parallel, on some combination of multiple cores and multiple processors.</p><p>And our goal in optimization is to keep modifying the source code in attempt to coax the compiler into generating efficient
code. Compared to the alternative of writing code in assembly language, this indirect approach has the advantage that
the resulting code will still run on other machines, although perhaps not with peak performance.</p><p>Compilers must be careful to apply only safe optimizations to a program, meaning that the the resulting program will have
the exact same behavior as would an unoptimized version for all possible cases the program may encounter.</p><p>The first problem is the <em>memory aliasing</em> that two pointers designate the same memory location, and in performing only
safe optimizations, the compiler must assume that different pointers may be aliased. If a compiler cannot determine whether
or not twopointers may be aliased, it must assume that either case is possible, limiting the set of possible optimizations</p><p>A second optimization blocker is due to function calls. It&rsquo;s hard to optimize the function calls with side effect, which
modifies some part of the global program state. Most compilers do not try to determine whether a function is free of side
effects, instead the compiler assumes the worse case and leaves function calls intact. Among compilers, GCC is considered
adequate, but not exceptional.</p><p>We introduce the metric <em>cycles per element(CPE)</em>, CPE measurements help us understand the loop performance of an iterative
program at a detailed level. The sequencing of activities by a processor is controlled by a clock providing a regular
signal of some frequency, usually expressed in <em>gigahertz(GHz)</em>, billions of cycles per second. For example, when product
literature characterizes a system as &ldquo;4 GHz&rdquo; processor, it means that the processor clock runs at 4.0E9 cycles per second,
and the period of the processor is 0.25 nanoseconds, which is the reciprocal of the clock frequency.</p><p>For example, consider the two programs of computing the prefix sum of a vector a:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-C data-lang=C><span class=kt>void</span> <span class=nf>psum1</span><span class=p>(</span><span class=kt>float</span> <span class=n>a</span><span class=p>[],</span> <span class=kt>float</span> <span class=n>p</span><span class=p>[],</span> <span class=kt>long</span> <span class=n>n</span><span class=p>)</span> <span class=p>{</span>
    <span class=kt>long</span> <span class=n>i</span><span class=p>;</span>
    <span class=n>p</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>a</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
    <span class=k>for</span> <span class=p>(</span><span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>p</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>p</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=kt>void</span> <span class=nf>psum2</span><span class=p>(</span><span class=kt>float</span> <span class=n>a</span><span class=p>[],</span> <span class=kt>float</span> <span class=n>p</span><span class=p>[],</span> <span class=kt>long</span> <span class=n>n</span><span class=p>)</span> <span class=p>{</span>
    <span class=kt>long</span> <span class=n>i</span><span class=p>;</span> 
    <span class=n>p</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>a</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
    <span class=k>for</span> <span class=p>(</span><span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>+=</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>float</span> <span class=n>mid_val</span> <span class=o>=</span> <span class=n>p</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
        <span class=n>p</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>mid_val</span><span class=p>;</span>
        <span class=n>p</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>mid_val</span> <span class=o>+</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>];</span>
    <span class=p>}</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>p</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>p</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div><p>They takes 368 + 9.0n cycles and 368 + 6.0 cycles, for lagre N the run times will be dominated by the linear factors. We
refer to the coefficients in these terms as the effective number of cycle per element, so the first one&rsquo;s CPE is 9.0 and
the second one is 6.0.</p><h3 id=modern-processors>Modern processors<a hidden class=anchor aria-hidden=true href=#modern-processors>#</a></h3><p>One of the remarkable feats of modern microprocessors is they employ complex and exotic microarchitectures, in which
multiple instructions can be executed in parallel, while presenting an operational view of simple sequential instruction
execution. There are two different lower bounds characterize the maximum performance of a program. The <em>latency bound</em>
is encountered when a series of operations must performed in strict sequence, because the result of one operations is
required before the next one can begin. This bound can limit program performance when the data dependencies in the code
limit the ability of the processor to exploit instruction-level parallelism. The <em>throughput bound</em> characterizes the
raw computing capacity of the processor&rsquo;s functional units. This bound becomes the ultimate limit on program performance.</p><h3 id=trick>Trick<a hidden class=anchor aria-hidden=true href=#trick>#</a></h3><ul><li><em>code motion</em>: Identify a computation that is performed multiple times but such that the result of the computation will
not change, and therefor move the computation to an eailer section of the code that does not get evaluated as often.</li><li><em>eliminate unneeded menory reference</em>: For frequent memory reference, it could be improved by introduced a temporary
variables instead of using memory referencing(pointer) in a loop.</li><li><em>loop unrolling</em>: Reduce the number of iterations for a loop by increasing the number of elements computed on each
iteration. It can improve performance in two ways. First, it reduces the number of operations that do not contribute
directly to the program result, such as loop indexing and conditional branching. Second, it expose ways in which we can
futher transform the code to reduce the number of operations in the cirtical paths of the overall computation.</li></ul><h2 id=the-memory-hierarchy>The Memory Hierarchy<a hidden class=anchor aria-hidden=true href=#the-memory-hierarchy>#</a></h2><h3 id=random-access-memory>Random-access memory<a hidden class=anchor aria-hidden=true href=#random-access-memory>#</a></h3><p><em>Random-access memory</em>(RAM) comes in two varieties, static and dynamic. <em>Static RAM</em>(SRAM) is faster and significantly
more expensive than <em>dynamic RAM</em>(DRAM). SRAM is used for cache memories, both on and off the CPU chip. DRAM is used for
the amin memory plus the frame buffer of a graphics system.</p><h3 id=read-only-memory>Read-only memory<a hidden class=anchor aria-hidden=true href=#read-only-memory>#</a></h3><p><em>Read-only memory</em> can retain their information even when they are powered off, while the RAM lose their information if
the supply voltage is turned off. <em>flash memory</em> is a type of nonvolstile memory, based on EEPROM(<em>electrically erasable
programmable ROM</em>), that has become an important storage rechnology. The <em>solid state disk</em>(SSD), that provides a faster,
sturdier and less power-hungry alternative to conventional rotating disk is a new form of flash-based disk driver.</p><h2 id=principle-of-locality>Principle of Locality<a hidden class=anchor aria-hidden=true href=#principle-of-locality>#</a></h2><p>programs with good locality run faster than programs with poor locality. Locality is typically described as having two
distinct forms: <em>temporal locality</em> and <em>spatial locality</em>. In a program with good temporal locality, a memory location
that is referenced once is likely to be referenced again multiple times in the near future. In a program with good spatial
locality, if a memory location that is referenced once, then the program is likely to reference a nearby memory location
in the near future.</p><p>Consider a program of matrix multiplication(C=AxB):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-C data-lang=C><span class=k>for</span> <span class=p>(</span><span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
    <span class=k>for</span> <span class=p>(</span><span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>sum</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>;</span>
        <span class=k>for</span> <span class=p>(</span><span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=n>p</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>sum</span> <span class=o>+=</span> <span class=n>A</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>k</span><span class=p>]</span> <span class=o>*</span> <span class=n>B</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>j</span><span class=p>];</span>
        <span class=p>}</span>
        <span class=n>C</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>sum</span><span class=p>;</span>
    <span class=p>}</span>
</code></pre></td></tr></table></div></div><p>if we switch the loop order for j and k:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-C data-lang=C><span class=k>for</span> <span class=p>(</span><span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
    <span class=k>for</span> <span class=p>(</span><span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=n>p</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>r</span> <span class=o>=</span> <span class=n>A</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>k</span><span class=p>]</span>
        <span class=k>for</span> <span class=p>(</span><span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>m</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>C</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>+=</span> <span class=n>r</span> <span class=o>*</span> <span class=n>B</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>j</span><span class=p>];</span>
        <span class=p>}</span>
    <span class=p>}</span>
</code></pre></td></tr></table></div></div><p>these will not change the result, but the second improves efficiency. Because the second has no cache missing.</p><ul><li>Programs that repeatedly reference the same variables enjoy good temporal locality.</li><li>For programs with stride-k reference patterns, the smaller the stride the better the spatial locality. Programs with
stride-1 reference patterns have good spatial locality. Programs that hop around memory with large strides have poor
spatial locality.</li><li>Loops have good temporal and spatial locality with respect to instruction fetches. The smaller the loop body and the
greater the number of loopiterations, the better the locality.</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://christophe1997.github.io/tags/system>System</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Computer System 3 on twitter" href="https://twitter.com/intent/tweet/?text=Computer%20System%203&url=https%3a%2f%2fchristophe1997.github.io%2fposts%2f2018%2fcomputer-system-3%2f&hashtags=System"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zm-253.927 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Computer System 3 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fchristophe1997.github.io%2fposts%2f2018%2fcomputer-system-3%2f&title=Computer%20System%203&summary=Computer%20System%203&source=https%3a%2f%2fchristophe1997.github.io%2fposts%2f2018%2fcomputer-system-3%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0v-129.439c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02v-126.056c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768h75.024zm-307.552-334.556c-25.674.0-42.448 16.879-42.448 39.002.0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Computer System 3 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fchristophe1997.github.io%2fposts%2f2018%2fcomputer-system-3%2f&title=Computer%20System%203"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zm-119.474 108.193c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zm-160.386-29.702c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Computer System 3 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fchristophe1997.github.io%2fposts%2f2018%2fcomputer-system-3%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978v-192.915h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Computer System 3 on whatsapp" href="https://api.whatsapp.com/send?text=Computer%20System%203%20-%20https%3a%2f%2fchristophe1997.github.io%2fposts%2f2018%2fcomputer-system-3%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23-13.314-11.876-22.304-26.542-24.916-31.026s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Computer System 3 on telegram" href="https://telegram.me/share/url?text=Computer%20System%203&url=https%3a%2f%2fchristophe1997.github.io%2fposts%2f2018%2fcomputer-system-3%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47A3.38 3.38.0 0126.49 29.86zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2020 <a href=https://christophe1997.github.io>CastOff</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top" accesskey=g><button class=top-link id=top-link type=button><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6"><path d="M12 6H0l6-6z"/></svg></button></a>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css integrity=sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js integrity=sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload="renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:true},{left:'$',right:'$',display:false}]});"></script><script>window.onload=function(){if(localStorage.getItem("menu-scroll-position")){document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position");}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});});});var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft);}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script></body></html>